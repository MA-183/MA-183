![[Kapittel 2 - derivasjon/Definisjoner og teoremer/Teo 2.4.6 Kjerneregelen#^ad9861|Teo 2.4.6]]

En alt for forenklet (men enkel måte å huske kjerneregelen) er å tenke på den slik. 
$$\begin{aligned}  \frac{df}{dx} = \frac{df}{dg} \frac{dg}{dx}. \end{aligned}$$ 
Kjerneregelen er på en måte en av de mest intuitive derivasjonsreglene vi har. Beviset for kjerneregelen kommer lenger ned.

> [!abstract]- Intuisjon med lineær approksimasjon
> 
> Tenk deg at $f$ er en funksjon av $g$, altså $f(g)$ og at $g$ er en funksjon av $x$. Hvis $g$ er deriverbar i $a$, og $f$ er deriverbar i $c = g(a)$ så kan vi tenke slik.
> 
> Funksjonen $f$ er praktisk talt lineær rundt $c$ (med hensyn på $g$) og kan approksimeres med $f(c)+f'(c)(g-c)$. Siden $g$ er en funksjon av $x$ kan vi derivere med hensyn på $x$ og få
> $$
> \frac{d}{dx} f(g(x)) = f'(c)(g'(x)) = f'(g(a))g'(x).
> $$ 
> Vi vet at dette blir mer og mer riktig, jo nærmere vi går $x = a$. Spesielt bør dette bety at i $a$ så er $\frac{d}{dx} f(g(x))\bigg|_{x=a} = f'(g(a))g'(a)$.

> [!abstract]- Alternativ intuisjon for kjerneregel
> Tenk deg at du ser på to funksjoner $f(x) =x^2$ og $f(3x)= (3x)^2$.
> 
> Ser vi på deres grafer ser vi at $f(3x)$ ser ut til å være *krympet* inn. Altså at man har krympet x-aksen.
> 
> <iframe src="https://www.desmos.com/calculator/qne2wt5lot?embed" width="500" height="500" style="border: 1px solid" frameborder=0></iframe>
> 
> Dette kan vi tenke på som at når vi kjører gjennom $x$ verdiene vil $f(3x)$ kjøre gjennom tre ganger så raskt. Det må jo også bety at siden *farten* til $3x$ går tre ganger så fort, må stigningen til grafen også være tre ganger så stort i hvert punkt.
> 
> Vi må holde tunga rett i munnen her. Merk stigningen til grafen $f(3x)$ når $x=1$ er ikke lik stigningen til grafen $f(x)$ når $x=3$, selv om funksjonsverdien er den samme. Stigningen er **tre ganger** raskere. Vi har altså at for $x=1$ så er $\frac{d}{dx}f(3x) \bigg|_{x=1} = 3\cdot \frac{d}{dx}f(x)\bigg|_{x=3}$
> 
> Nå kommer det et lite hopp som vi må tenke gjennom. Hva skjer hvis vi endrer $3x$ med en funksjon $g(x)$? Jo, mengden som $f(g(x))$ vil strekkes eller krympes i forhold til $f(x)$ avhenger av hvordan $g(x)$ oppfører seg. Dersom $g(x)$ har stigning $3$ i et punkt, vil $g(x)$ oppføre seg som den lineære funksjonen $3x$ i det punktet, og da bør $f$ ha tre ganger så stor stigning. Dersom $g(x)$ var $\frac{1}{2}$ så ville $f(g(x))$ bremses ned i punktet og stigningen måtte bli halvparten så stor. Se for eksempel $\sin (x)$ og $\sin(x^2)$ under.
> 
> <iframe src="https://www.desmos.com/calculator/2pli9h4g3s?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>
> 
> Det må bety at stigningen til $f(g(x))$, som bare er $\frac{d}{dx}f(g(x))$, involverer å finne stigningen til $f$ i tilhørende punkt $g(x)$ og multiplisere dette med stigningen til $g(x)$ i punktet $x$. Med andre ord
> $$\begin{aligned} (f(g(x)))'(x)=g'(x)f'(g(x)).  \end{aligned}$$ 


> [!note] Bevis for kjerneregelen

Anta at $f$ er deriverbar i et punkt $u = g(a)$ og at $g$ er deriverbar i $a$. 

La $E(k)$ være definert ved 
$$\begin{aligned} & E(0) = 0  \\ & E(k) = \frac{f(u+k)-f(u) }{k } -f'(u) && \text{hvis } k\neq 0.\end{aligned}$$

Fra definisjonen av den deriverte er $\lim_{k \longrightarrow 0 } E(k) = f'(u)-f'(u) = 0 = E(0)$, så $E(k)$ er kontinuerlig i $k = 0$. I tillegg har vi at 
$$\begin{aligned} f(u+k)-f(u) = (f'(u)+E(k))k  \end{aligned}$$ 
La $k = g(a+h)-g(a)$, og husk at $u = g(a)$ slik at $u+k = g(a+h)$ og merk at vi får
$$\begin{aligned} f(g(a+h)) - f(g(a)) &= (f'(g(a))+E(k))(g(a+h)-g(a)) \\ \phantom{} \\ &\text{eller at } \\  \phantom{} \\\frac{f(g(a+h)) - f(g(a))}{h} &= (f'(g(a))+E(k))\frac{(g(a+h)-g(a)) }{h}. \end{aligned}$$

Vi skal nå bruke noen [[Kapittel 1 - grenser og kontinuitet/Definisjoner og teoremer/Teo 1.2.2 Grenseverdiregler|grenseverdiregler]] til å si noe om grensen av høyre siden av likningen over når $h \longrightarrow  0$.

1. $g$ er deriverbar i $a$ er $\frac{k}{h} \longrightarrow g'(a)$ når $h\longrightarrow 0$ per definisjon
    - I tillegg gir deriverbarhet i $a$ kontinuitet i $a$ så $k \longrightarrow 0$ når $h \longrightarrow  0$.
2. Siden $E(k) \longrightarrow 0$ når $k\longrightarrow 0$ og $k \longrightarrow  0$ når $h \longrightarrow 0$ så har vi at siden [[Kapittel 1 - grenser og kontinuitet/Definisjoner og teoremer/Teo 1.4.7 Komposisjoner av kontinuerlige funksjoner er kontinuerlig|komposisjoner av kontinuerlige funksjoner er kontinuerlig]] så vil $E(k) \longrightarrow  0$ når $h \longrightarrow  0$.

Det gir oss at
$$
\begin{aligned} 
   &\lim_{h\longrightarrow  0} \frac{f(g(a+h)) - f(g(a))}{h} \\ \phantom{} \\  = & \lim_{h\longrightarrow  0}\frac{(f'(g(a))+E(k))(g(a+h)-g(a)) }{h} \\ \phantom{} \\  = & \lim_{h\longrightarrow  0}{\color{#40c057} (f'(g(a))+E(k)) }{\color{#e599f7} \frac{(g(a+h)-g(a)) }{h} } \\ \phantom{} \\  = & {\color{#40c057} f'(g(a)) } \cdot \ {\color{#e599f7} g'(a) }.
\end{aligned} 
$$
Merk at grønn er [[Kapittel 1 - grenser og kontinuitet/Definisjoner og teoremer/Teo 1.2.2 Grenseverdiregler|punkt 1]] kombinert med 2. over. At $\lim{\color{#40c057} \text{grønn} } \cdot {\color{#e599f7} \text{rosa} } = {\color{#40c057} \text{grønn} } \cdot {\color{#e599f7} \text{rosa} }$ er [[Kapittel 1 - grenser og kontinuitet/Definisjoner og teoremer/Teo 1.2.2 Grenseverdiregler|punkt 3]] kombinert med 1. over.

Nå har vi kontroll på derivasjon av elementære sammensetninger av deriverbare funksjoner. Neste naturlige spørsmål blir å se på derivasjon av trigonometriske funksjoner. For å gjøre det må vi først se på noen [[Kapittel 2 - derivasjon/2.5.1 Spesielle trigonometriske grenser|spesielle trigonometriske grenser]].